version: 2.1
# Use a package of configuration called an orb.
orbs:
  # Declare a dependency on the welcome-orb
  python: circleci/python@0.2.1
# Orchestrate or schedule a set of jobs
workflows:
  # Name the workflow "welcome"
  welcome:
    # Run the welcome/run job in its own container
    jobs:
        build:
            working_directory: /dockerapp
            docker:
                - image: docker:17.05.0-ce-git
            steps:
                - checkout
                - setup_remote_docker
                - run:
                    name: Install dependencies
                    command: |
                        apk add --no-cache py-pip=9.0.0-r1
                        pip install docker-compose==1.15.0                         
                - run:
                    name: Run tests
                    command: |
                        docker-compose up -d
                        docker-compose run dockerapp python test.py